<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 PCA | NLP for Healthcare</title>
  <meta name="description" content="4 PCA | NLP for Healthcare" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="4 PCA | NLP for Healthcare" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://ucdavisdatalab.github.io/workshop-nlp-healthcare" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 PCA | NLP for Healthcare" />
  
  
  

<meta name="author" content="Dr. Pamela Reynolds" />
<meta name="author" content="Dr. Wesley Brooks" />
<meta name="author" content="Arthur Koehl" />


<meta name="date" content="2021-02-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="working-with-text-data-in-r.html"/>

<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://datalab.ucdavis.edu/">
<img src="img/datalab-logo-full-color-rgb.png" style="height: 100%; width: 100%; object-fit: contain" />
</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#objectives-for-this-workshop"><i class="fa fa-check"></i><b>1.1</b> Objectives for this Workshop</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro-to-nlp.html"><a href="intro-to-nlp.html"><i class="fa fa-check"></i><b>2</b> Intro to NLP</a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="intro-to-nlp.html"><a href="intro-to-nlp.html#whats-a-natural-language"><i class="fa fa-check"></i><b>2.0.1</b> What’s a Natural Language?</a></li>
<li class="chapter" data-level="2.0.2" data-path="intro-to-nlp.html"><a href="intro-to-nlp.html#history-of-nlp"><i class="fa fa-check"></i><b>2.0.2</b> History of NLP</a></li>
<li class="chapter" data-level="2.0.3" data-path="intro-to-nlp.html"><a href="intro-to-nlp.html#caveats-before-we-get-started"><i class="fa fa-check"></i><b>2.0.3</b> Caveats before we get started</a></li>
<li class="chapter" data-level="2.0.4" data-path="intro-to-nlp.html"><a href="intro-to-nlp.html#text-processing"><i class="fa fa-check"></i><b>2.0.4</b> Text processing</a></li>
<li class="chapter" data-level="2.0.5" data-path="intro-to-nlp.html"><a href="intro-to-nlp.html#where-to-go-to-learn-more"><i class="fa fa-check"></i><b>2.0.5</b> Where to go to learn more</a></li>
<li class="chapter" data-level="2.1" data-path="intro-to-nlp.html"><a href="intro-to-nlp.html#demo-introduction"><i class="fa fa-check"></i><b>2.1</b> Demo introduction</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="intro-to-nlp.html"><a href="intro-to-nlp.html#about-the-data"><i class="fa fa-check"></i><b>2.1.1</b> About the data</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro-to-nlp.html"><a href="intro-to-nlp.html#why-r-what-is-rstudio"><i class="fa fa-check"></i><b>2.1.2</b> Why R? What is RStudio?</a></li>
<li class="chapter" data-level="2.1.3" data-path="intro-to-nlp.html"><a href="intro-to-nlp.html#further-resources"><i class="fa fa-check"></i><b>2.1.3</b> Further resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="working-with-text-data-in-r.html"><a href="working-with-text-data-in-r.html"><i class="fa fa-check"></i><b>3</b> Working with Text Data in R</a>
<ul>
<li class="chapter" data-level="3.0.1" data-path="working-with-text-data-in-r.html"><a href="working-with-text-data-in-r.html#packages-needed-for-workshop"><i class="fa fa-check"></i><b>3.0.1</b> packages needed for workshop</a></li>
<li class="chapter" data-level="3.0.2" data-path="working-with-text-data-in-r.html"><a href="working-with-text-data-in-r.html#data-for-this-workshop"><i class="fa fa-check"></i><b>3.0.2</b> data for this workshop</a></li>
<li class="chapter" data-level="3.1" data-path="working-with-text-data-in-r.html"><a href="working-with-text-data-in-r.html#preprocessing"><i class="fa fa-check"></i><b>3.1</b> Preprocessing</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="working-with-text-data-in-r.html"><a href="working-with-text-data-in-r.html#load-the-text-column-into-a-corpus-object"><i class="fa fa-check"></i><b>3.1.1</b> Load the text column into a ‘corpus’ object</a></li>
<li class="chapter" data-level="3.1.2" data-path="working-with-text-data-in-r.html"><a href="working-with-text-data-in-r.html#preprocess-the-corpus-object"><i class="fa fa-check"></i><b>3.1.2</b> Preprocess the corpus object</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="working-with-text-data-in-r.html"><a href="working-with-text-data-in-r.html#the-bag-of-words-representation"><i class="fa fa-check"></i><b>3.2</b> The Bag of Words Representation</a></li>
<li class="chapter" data-level="3.3" data-path="working-with-text-data-in-r.html"><a href="working-with-text-data-in-r.html#the-document-term-matrix"><i class="fa fa-check"></i><b>3.3</b> The Document Term Matrix</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="working-with-text-data-in-r.html"><a href="working-with-text-data-in-r.html#creating-a-document-term-matrix-from-the-corpus-object"><i class="fa fa-check"></i><b>3.3.1</b> Creating a Document Term Matrix from the corpus object</a></li>
<li class="chapter" data-level="3.3.2" data-path="working-with-text-data-in-r.html"><a href="working-with-text-data-in-r.html#exploring-with-a-dtm"><i class="fa fa-check"></i><b>3.3.2</b> Exploring with a DTM</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="working-with-text-data-in-r.html"><a href="working-with-text-data-in-r.html#tf-idf"><i class="fa fa-check"></i><b>3.4</b> TF-IDF</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="working-with-text-data-in-r.html"><a href="working-with-text-data-in-r.html#intuition-behind-tf-idf"><i class="fa fa-check"></i><b>3.4.1</b> Intuition behind TF-IDF</a></li>
<li class="chapter" data-level="3.4.2" data-path="working-with-text-data-in-r.html"><a href="working-with-text-data-in-r.html#tf-idf-formula"><i class="fa fa-check"></i><b>3.4.2</b> TF-IDF formula</a></li>
<li class="chapter" data-level="3.4.3" data-path="working-with-text-data-in-r.html"><a href="working-with-text-data-in-r.html#tf-idf-from-dtm"><i class="fa fa-check"></i><b>3.4.3</b> TF-IDF from DTM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>4</b> PCA</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NLP for Healthcare</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pca" class="section level1" number="4">
<h1><span class="header-section-number">4</span> PCA</h1>
<div id="a.-intuition-behind-pca" class="section level4" number="4.0.0.1">
<h4><span class="header-section-number">4.0.0.1</span> a. Intuition behind PCA</h4>
<p>The most straightforward way to visualize the information in the TF-IDF matrix is to plot its columns, but this is unsatisfactory because there are thousands of them, and each column is mostly zeroes (so contains little information):</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="pca.html#cb27-1" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">as.matrix</span>(tfidf_dtm[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]))</span></code></pre></div>
<p><img src="03_pca_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Our answer is to use principal components analysis (PCA), which rotates the big matrix until we are “looking” down the “direction” (or component) with the most variability. The result is another matrix of equal size to the first, but each column contains information from all of the columns of the original matrix, and they are sorted so that the most important columns are first. We can observe get the most important relationships by focusing on just a few of these “principal components”. Let’s continue with our example:</p>
</div>
<div id="b.-computing-pca" class="section level4" number="4.0.0.2">
<h4><span class="header-section-number">4.0.0.2</span> b. Computing PCA</h4>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="pca.html#cb28-1" aria-hidden="true"></a>articles &lt;-<span class="st"> </span><span class="kw">t</span>(tfidf_dtm)</span>
<span id="cb28-2"><a href="pca.html#cb28-2" aria-hidden="true"></a>mypca &lt;-<span class="st"> </span><span class="kw">prcomp</span>(articles, <span class="dt">center=</span><span class="ot">TRUE</span>, <span class="dt">scale=</span><span class="ot">TRUE</span>)</span></code></pre></div>
</div>
<div id="c.-plotting-the-abstracts" class="section level4" number="4.0.0.3">
<h4><span class="header-section-number">4.0.0.3</span> c. Plotting the abstracts</h4>
<p>Add the principal components to the original data:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="pca.html#cb29-1" aria-hidden="true"></a>plotdata &lt;-<span class="st"> </span><span class="kw">cbind</span>(data, mypca<span class="op">$</span>rotation)</span></code></pre></div>
<p>And now plot the abstracts. Each dot in the figure represents one abstract.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="pca.html#cb30-1" aria-hidden="true"></a><span class="kw">ggplot</span>(plotdata) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x=</span>PC1, <span class="dt">y=</span>PC2) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="03_pca_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Now let’s identify some articles from the plot.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="pca.html#cb31-1" aria-hidden="true"></a>min_index &lt;-<span class="st"> </span><span class="kw">order</span>(plotdata<span class="op">$</span>PC1, <span class="dt">decreasing=</span><span class="ot">FALSE</span>)</span>
<span id="cb31-2"><a href="pca.html#cb31-2" aria-hidden="true"></a>max_index &lt;-<span class="st"> </span><span class="kw">order</span>(plotdata<span class="op">$</span>PC1, <span class="dt">decreasing=</span><span class="ot">TRUE</span>)</span>
<span id="cb31-3"><a href="pca.html#cb31-3" aria-hidden="true"></a></span>
<span id="cb31-4"><a href="pca.html#cb31-4" aria-hidden="true"></a><span class="co"># view the most divergent titles:</span></span>
<span id="cb31-5"><a href="pca.html#cb31-5" aria-hidden="true"></a>plotdata<span class="op">$</span>title[min_index[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>]]</span></code></pre></div>
<pre><code>## [1] &quot;Signal transduction pathways regulated by CSF-1 receptors modulate the in vitro radiosensitivity of mammary epithelial cells.&quot;                                                                                                                           
## [2] &quot;Creation of an episode-based payment model for prostate and breast cancer radiation therapy.&quot;                                                                                                                                                            
## [3] &quot;Erratum to: Wang SY, Kelly G, Gross C, et al. Information needs of older women with early-stage breast cancer when making radiation therapy decisions. [Int J Radiat Oncol Biol Phys 2017;98:733-740](S0360301617303097)(10.1016/j.ijrobp.2017.02.001)).&quot;
## [4] &quot;Molecular radiation therapy in experimental model of advanced prostate cancer using internalizable monoclonal antibody.&quot;                                                                                                                                 
## [5] &quot;Dna double-strand break repair and induction of apoptosis in relation to late normal tissue responses following radiation therapy for early breast cancer.&quot;                                                                                              
## [6] &quot;Patient experience survey of early-stage breast cancer patients undergoing whole-breast radiation therapy.&quot;</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="pca.html#cb33-1" aria-hidden="true"></a>plotdata<span class="op">$</span>title[max_index[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>]]</span></code></pre></div>
<pre><code>## [1] &quot;Differences in Patterns of Failure in Patients Treated With Accelerated Partial Breast Irradiation Versus Whole-Breast Irradiation: A Matched-Pair Analysis With 10-Year Follow-Up.&quot;                                                            
## [2] &quot;Margin status an indication for accelerated partial breast irradiation in early-stage breast cancers.&quot;                                                                                                                                          
## [3] &quot;Daily Fractionation of External Beam Accelerated Partial Breast Irradiation to 40 Gy Is Well Tolerated and Locally Effective.&quot;                                                                                                                  
## [4] &quot;Accelerated partial-breast irradiation provides equivalent 10-year outcomes to whole breast irradiation: A matched-pair analysis.&quot;                                                                                                              
## [5] &quot;Accelerated partial breast irradiation using sole interstitial multicatheter brachytherapy versus whole breast irradiation for early breast cancer: Five-year results of a randomized phase 3 trial-Part I: Local control and survival results.&quot;
## [6] &quot;Phase I/II Study Evaluating Early Tolerance in Breast Cancer Patients Undergoing Accelerated Partial Breast Irradiation Treated With the MammoSite Balloon Breast Brachytherapy Catheter Using a 2-Day Dose Schedule.&quot;</code></pre>
<p>Visualize the explained variance. This is the metric that PCA uses to decide which components are the most important.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="pca.html#cb35-1" aria-hidden="true"></a><span class="kw">plot</span>(<span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="kw">cumsum</span>(mypca<span class="op">$</span>sdev<span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(mypca<span class="op">$</span>sdev<span class="op">^</span><span class="dv">2</span>), <span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">bty=</span><span class="st">&#39;n&#39;</span>, <span class="dt">ylab=</span><span class="st">&quot;% total variance explained&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Number of components&quot;</span>)</span></code></pre></div>
<p><img src="03_pca_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Let’s add some additional information: a few top terms from each abstract. These are the most characeristic terms from the abstract, as ranked by TF-IDF. We’ll plot the abstracts on the 2nd and 3rd principal components, annotated by the top terms.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="pca.html#cb36-1" aria-hidden="true"></a><span class="kw">source</span>(<span class="kw">url</span>(<span class="st">&quot;https://ucdavisdatalab.github.io/workshop-nlp-healthcare/top_terms.R&quot;</span>))</span>
<span id="cb36-2"><a href="pca.html#cb36-2" aria-hidden="true"></a>plotdata[[<span class="st">&#39;top_terms&#39;</span>]] &lt;-<span class="st"> </span><span class="kw">top_terms</span>(tfidf_dtm)</span>
<span id="cb36-3"><a href="pca.html#cb36-3" aria-hidden="true"></a><span class="kw">ggplot</span>(plotdata) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x=</span>PC2, <span class="dt">y=</span>PC3, <span class="dt">label=</span>top_terms) <span class="op">+</span><span class="st"> </span><span class="kw">geom_text</span>(<span class="dt">check_overlap=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="03_pca_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>We’re also going to look at k-means to identify clusters in data. To begin, let’s include some abstracts dealing with cervical cancer from the same journals as the breast cancer abstracts.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="pca.html#cb37-1" aria-hidden="true"></a>cervical &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="kw">url</span>(<span class="st">&quot;https://ucdavisdatalab.github.io/workshop-nlp-healthcare/cervical-abstracts.csv&quot;</span>))</span>
<span id="cb37-2"><a href="pca.html#cb37-2" aria-hidden="true"></a>data[[<span class="st">&quot;topic&quot;</span>]] &lt;-<span class="st"> &quot;breast&quot;</span></span>
<span id="cb37-3"><a href="pca.html#cb37-3" aria-hidden="true"></a>cervical[[<span class="st">&quot;topic&quot;</span>]] &lt;-<span class="st"> &quot;cervical&quot;</span></span>
<span id="cb37-4"><a href="pca.html#cb37-4" aria-hidden="true"></a>combined &lt;-<span class="st"> </span><span class="kw">rbind</span>(data, cervical)</span></code></pre></div>
<p>Rather than processing the combined abstracts step-by-step, let’s grab a function to replicate the processing we did on the breast cancer abstracts. This time, though, the terms “breast” “cervical”, and “cervix” will be removed prior to the analysis.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="pca.html#cb38-1" aria-hidden="true"></a><span class="kw">source</span>(<span class="kw">url</span>(<span class="st">&quot;https://ucdavisdatalab.github.io/workshop-nlp-healthcare/get_corpus.R&quot;</span>))</span>
<span id="cb38-2"><a href="pca.html#cb38-2" aria-hidden="true"></a>pca_combined &lt;-<span class="st"> </span><span class="kw">get_corpus</span>(combined, <span class="dt">remove=</span><span class="kw">c</span>(<span class="st">&quot;cervical&quot;</span>, <span class="st">&quot;cervix&quot;</span>, <span class="st">&quot;breast&quot;</span>))</span>
<span id="cb38-3"><a href="pca.html#cb38-3" aria-hidden="true"></a>data_combined &lt;-<span class="st"> </span><span class="kw">cbind</span>(combined, pca_combined<span class="op">$</span>rotation)</span></code></pre></div>
<p>We now have a PCA of the combined abstracts, so let’s see how the first few components look:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="pca.html#cb39-1" aria-hidden="true"></a><span class="kw">ggplot</span>(data_combined) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x=</span>PC1, <span class="dt">y=</span>PC2, <span class="dt">color=</span>topic) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="03_pca_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="pca.html#cb40-1" aria-hidden="true"></a><span class="kw">ggplot</span>(data_combined) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x=</span>PC2, <span class="dt">y=</span>PC3, <span class="dt">color=</span>topic) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="03_pca_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<p>If we didn’t know the correct labels, we can let the computer pick them itself. One commonly-used method that’s built into R is k-means classification. K-means identifies clusters in data based on maximizing the similarity within groups while maximizing the dissimilarity between groups. It is often best to use PCA for dimension-reduction before applying PCA because separation between points increases with the square of the number of dimensions, and that separation makes clustering less effective. Here I will be quite aggressive and use only three principal components.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="pca.html#cb41-1" aria-hidden="true"></a>km &lt;-<span class="st"> </span><span class="kw">kmeans</span>(pca_combined<span class="op">$</span>rotation[, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dv">2</span>, <span class="dt">iter.max=</span><span class="fl">1e3</span>, <span class="dt">nstart=</span><span class="dv">100</span>)</span>
<span id="cb41-2"><a href="pca.html#cb41-2" aria-hidden="true"></a>km_fit &lt;-<span class="st"> </span><span class="kw">fitted</span>(km, <span class="dt">method=</span><span class="st">&quot;classes&quot;</span>)</span>
<span id="cb41-3"><a href="pca.html#cb41-3" aria-hidden="true"></a>data_combined[[<span class="st">&quot;group_fit&quot;</span>]] &lt;-<span class="st"> </span><span class="kw">as.factor</span>(km_fit)</span>
<span id="cb41-4"><a href="pca.html#cb41-4" aria-hidden="true"></a></span>
<span id="cb41-5"><a href="pca.html#cb41-5" aria-hidden="true"></a><span class="kw">ggplot</span>(data_combined) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x=</span>PC2, <span class="dt">y=</span>PC3, <span class="dt">color=</span>group_fit) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="03_pca_files/figure-html/k-means-1.png" width="672" /></p>
<p>Another way to explore the result of k-means is to look at the articles that are most characteristic of each cluster. First, calculate the sum of squared residuals for each article.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="pca.html#cb42-1" aria-hidden="true"></a>km_residual &lt;-<span class="st"> </span>pca_combined<span class="op">$</span>rotation[, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] <span class="op">-</span><span class="st"> </span><span class="kw">fitted</span>(km)</span>
<span id="cb42-2"><a href="pca.html#cb42-2" aria-hidden="true"></a>km_ss_residual &lt;-<span class="st"> </span><span class="kw">apply</span>(km_residual, <span class="dv">1</span>, var)</span>
<span id="cb42-3"><a href="pca.html#cb42-3" aria-hidden="true"></a>data_combined[[<span class="st">&quot;err&quot;</span>]] &lt;-<span class="st"> </span>km_ss_residual</span></code></pre></div>
<p>Now we can identify the articles within each group that have the smallest residuals. These are closest to the group center, and thus most characteristic of the group.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="pca.html#cb43-1" aria-hidden="true"></a>data_ordered &lt;-<span class="st"> </span>data_combined[<span class="kw">order</span>(data_combined[[<span class="st">&quot;err&quot;</span>]]),]</span>
<span id="cb43-2"><a href="pca.html#cb43-2" aria-hidden="true"></a><span class="kw">head</span>(data_ordered[[<span class="st">&quot;title&quot;</span>]][data_ordered[[<span class="st">&quot;group_fit&quot;</span>]] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] &quot;Screening for wart virus infection in normal and abnormal cervices by DNA hybridisation of cervical scrapes.&quot;                                                  
## [2] &quot;Viral load of human papillomavirus and risk of CIN3 or cervical cancer.&quot;                                                                                       
## [3] &quot;Progressive potential of mild cervical atypia: prospective cytological, colposcopic, and virological study.&quot;                                                   
## [4] &quot;Relation between human papillomavirus type 16 and potential for progression of minor-grade cervical disease.&quot;                                                  
## [5] &quot;HPV 16 DNA in normal and malignant cervical epithelium: implications for the aetiology and behaviour of cervical neoplasia.&quot;                                   
## [6] &quot;Final efficacy, immunogenicity, and safety analyses of a nine-valent human papillomavirus vaccine in women aged 16-26 years: a randomised, double-blind trial.&quot;</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="pca.html#cb45-1" aria-hidden="true"></a><span class="kw">head</span>(data_ordered[[<span class="st">&quot;title&quot;</span>]][data_ordered[[<span class="st">&quot;group_fit&quot;</span>]] <span class="op">==</span><span class="st"> </span><span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] &quot;Analysis of the Financial Impact of the 2018 ASTRO Breast Dose-Fractionation Guidelines on Radiation Oncology Departmental Reimbursement.&quot;                   
## [2] &quot;Patterns of breast recurrence in a pilot study of brachytherapy confined to the lumpectomy site for early breast cancer with six years&#39; minimum follow-up.&quot;  
## [3] &quot;Long-term radiation complications following conservative surgery (CS) and radiation therapy (RT) in patients with early stage breast cancer.&quot;                
## [4] &quot;Treatment-related toxicity from a randomized trial of the sequencing of doxorubicin and radiation therapy in patients treated for early stage breast cancer.&quot;
## [5] &quot;Local recurrence and survival for the german centers in the targit-a (targeted intraoperative radiation therapy-alone) trial.&quot;                               
## [6] &quot;Sphere of Equivalence-A Novel Target Volume Concept for Intraoperative Radiotherapy Using Low-Energy X Rays.&quot;</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="working-with-text-data-in-r.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"<li><a href="./" style="font-size": "18px">Workshop NLP for Healthcare</a></li>",
"sharing": false,
"view": "https://github.com/ucdavisdatalab/workshop-nlp-healthcare/blob/main/%s",
"edit": "https://github.com/ucdavisdatalab/workshop-nlp-healthcare/edit/main/%s"
}
});
});
</script>

</body>

</html>
